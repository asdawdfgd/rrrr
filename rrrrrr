FROM alpine:edge

# 1. تنزيل Tor وأداة التانل (Chisel)
RUN apk add --no-cache tor curl gzip
RUN curl -L https://github.com/jpillora/chisel/releases/download/v1.9.1/chisel_1.9.1_linux_amd64.gz | gzip -d > /bin/chisel && chmod +x /bin/chisel

# 2. إعداد Tor
RUN echo "SocksPort 9050" > /etc/tor/torrc

# 3. تشغيل الاثنين مع بعض (Tor في الخلفية والنفق في الواجهة)
# استبدل user:pass بأي يوزر وباسورد عايزهم للنفق
CMD tor -f /etc/tor/torrc & chisel server --port $PORT --auth admin:123456
